<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <link rel="stylesheet" href="style.css" type="text/css"/>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    </head>
    <body>

        <header > 
            <img  src="image/logo.png" alt="logo du site" id="logo" >
            <h1> Consultation en cours </h1> 
            <button id="boutonDeconnexion">Se déconnecter</button>
        </header>     


        <p> Vous êtes en consultation avec le client suivant: : </p>


        <!-- tableau qui va afficher le client -->
        <table style="width:100%">
            <tr>
                <th>
                    <p class="client_Nom">  </p>
                </th> 

                <th>
                    <p class="client_Genre">  </p>
                </th>
                <th>
                    <p class="client_num_tel">  </p>
                </th>
            </tr>
            <tr>
                <th>
                    <p class="client_mail">  </p> 
                </th> 
                <th>
                    <p class="client_adresse">  </p> 
                </th>
            </tr>

        </table><!-- comment -->



        <p> vous incarnez: </p>


        <!-- tableau qui va afficher le medium -->
        <table style="width:100%">
            <tr>
                <th>
                    <p class="Medium_Nom">  </p>
                </th> 

                <th>
                    <p class="Medium_Genre">  </p>
                </th>

            </tr>
            <tr>
                <th>
                    <p class="Medium_presentation">  </p> 
                </th> 

            </tr>

        </table><!-- comment -->


        <h2>Obtenir de l'aide</h2>     
        <h3>Entrez des notes de 1 à 4 pour chaque catégories sur l’échelle du bonheur</h3>

        <table style="width:100%">
            <tr>
                <th>
                    <div>
                        <label for="amour">Note amour (entre 1 et 4) :</label>
                        <input id="amour" type="number" name="balloons"  min="1" max="4" required>
                        <span class="validity"></span>
                    </div>

                </th>
                <th>
                    <div>
                        <label for="sante">Note santé (entre 1 et 4) :</label>
                        <input id="sante" type="number" name="balloons"  min="1" max="4" required>
                        <span class="validity"></span>
                    </div>

                </th><!-- comment -->
                <th>
                    <div>
                        <label for="travail">Note Travail (entre 1et 4) :</label>
                        <input id="travail" type="number" name="balloons"  min="1" max="4" required>
                        <span class="validity"></span>
                    </div>


                </th> 
                <th>
                    <button id="GO">GO</button>
                </th> 

            </tr>
            <<tr>
                <th>
                    <p class="Note_Amour"> aaaaaaaaaaaaaaaa</br>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</br>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  </p> 
                </th>
                <th>
                    <p class="Note_Sante"> aaaaaaaaaaaaaaaaaaa</br>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</br>aaaaaaaaaaaaaaaaaaaaaa </p> 
                </th><!-- comment -->
                <th>
                    <p class="Note_Travail"> aaaaaaaaaaaaa</br>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</br>aaaaaaaaaaaaaaaaaaaaaaaaaaa </p> 
                </th>         

            </tr>

        </table><!-- comment -->



        <input type="text" id="champ-denomination" size="80" placeholder="Pensez à laisser un commentaire sur la consultation" />

        <button id="boutonFinConsultation">J'ai fini la consultation</button>






        <footer>
            <p>  </p>
        </footer>





        <script>
            function obetnirinfoemp() {
                // Appel AJAX
                $.ajax({
                    url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'obtenirInfoUser'


                    },
                    dataType: 'json'
                }).done(function (response) { // Fonction appelée en cas d'appel AJAX réussi
                    console.log('Response', response); // LOG dans Console Javascript
                    if (response.connexion) {

                        var consult = response.consultations;
                        var consDemande = consult.consDemandee[0];
                        var client = consDemande.client;
                        var medium = consDemande.medium;
                        if (consDemande.length != 0) {

                            $('#consultationOrNot').css("display", "block");
                            $(".client_Nom").html(client.Prenom + " " + client.nom);
                            $(".client_Genre").html(" Genre : " + client.genre);
                            $(".client_num_tel").html(" tel : " + client.numTel);
                            $(".Medium_Nom").html(medium.denomination + " , " + medium.type);
                            $(".Medium_Genre").html("Genre :" + medium.genre);
                            $(".Medium_presentation").html("Description : " + medium.presentation);
                        } else {
                            $('#notification').html("Pas de demande de consultations actuellement");
                        }








                    } else {
                        $('#notification').html("Erreur de Connexion aux données"); // Message pour le paragraphe de notification
                    }
                })
                        .fail(function (error) { // Fonction appelée en cas d'erreur lors de l'appel AJAX
                            console.log('Error', error); // LOG dans Console Javascript
                            alert("Erreur lors de l'appel AJAX");
                        })
                        .always(function () { // Fonction toujours appelée

                        });
            }









            $(document).ready(function () {
                obetnirinfoemp();
                $('#boutonDeconnexion').on('click', function () {
                    window.location = './login.html';
                });
                $('#boutonFinConsultation').on('click', function () {
                    window.location = './TableauDeBordEmploye.html';
                    //et faire autre chose:utiliser le service de fin de consultation
                });
                $('#GO').on('click', function () {
                    ///appele a la servlet ici
                    $.ajax({
                        url: './ActionServlet',
                        method: 'POST',
                        data: {
                            todo: 'obtenirPrediction',
                            amour: $("input#amour").val(),
                            sante: $("input#sante").val(),
                            travail: $("textarea#msg").val()


                        },
                        dataType: 'json'
                    }).done(function (response) { // Fonction appelée en cas d'appel AJAX réussi
                        console.log('Response', response); // LOG dans Console Javascript
                        if (response.connexion) {
                            

                          

                        } else {
                            $('#notification').html("Erreur de Connexion aux données"); // Message pour le paragraphe de notification
                        }
                    })
                            .fail(function (error) { // Fonction appelée en cas d'erreur lors de l'appel AJAX
                                console.log('Error', error); // LOG dans Console Javascript
                                alert("Erreur lors de l'appel AJAX");
                            })
                            .always(function () { // Fonction toujours appelée

                            });
                });
                // Appelé à la fin du chargement de la page HTML initDonneesPage(); // Appel de la fonction pour initialiser les données de la page
            });


        </script>










    </body>
</html>
